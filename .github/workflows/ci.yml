name: Continuous Integration
on:
  push:
    branches:
      - main
    paths:
      - 'autocmd/*'
      - 'colors/*'
      - 'lua/*'
      - 'plugin/*'

jobs:
  fingerprint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Generate fingerprint
        run: make fingerprint

      - name: Check if fingerprint changed
        id: check_fp
        run: |
          [[ -n $(git diff-index HEAD --) ]] && status="commit" || status="skip"
          echo "status=$status" >> $GITHUB_OUTPUT

      - if: steps.check_fp.outputs.status == 'commit'
        name: Commit fingerprint
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: 'chore(fingerprint): autogenerated fingerprint'

